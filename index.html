<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Page Navigation with Inline Differences</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/diff/dist/diff.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
            color: #333;
        }
        h1, h3 {
            text-align: center;
        }
        .content {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        .text-section {
            width: 45%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fefefe;
        }
        .input-text, .rewritten-text {
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        .rewritten-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .small-arrow {
            font-size: 1.5em;
            cursor: pointer;
            user-select: none;
            padding: 5px 10px;
            border-radius: 50%;
            background-color: #007bff;
            color: white;
        }
        .small-arrow:hover {
            background-color: #0056b3;
        }
        .charts {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .chart-container {
            width: 45%;
        }
        .bert-score {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 5px 10px;
            font-size: 12px;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
            font-weight: bold;
        }
        .arrows {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        .arrow {
            font-size: 2em;
            cursor: pointer;
            user-select: none;
            padding: 10px 20px;
            border-radius: 50%;
            background-color: #007bff;
            color: white;
        }
        .arrow:hover {
            background-color: #0056b3;
        }
        .added {
            background-color: #d4f8d4; /* Green background for added text */
            font-weight: bold;
        }
        .removed {
            background-color: #f8d4d4; /* Red background for removed text */
            font-weight: bold;
            text-decoration: line-through;
        }
    </style>
</head>
<body>
    <h1 id="topic">Topic: William Farquhar and Singapore</h1>

    <div class="content">
        <div class="text-section">
            <h3>Original Text</h3>
            <div class="input-text" id="inputText">
                Original text will appear here.
            </div>
        </div>

        <div class="text-section">
            <div class="rewritten-header">
                <span class="small-arrow" onclick="navigateRewritten(-1)">&#8592;</span>
                <h3 id="rewrittenHeader">Rewritten Text: Toxic Emotions</h3>
                <span class="small-arrow" onclick="navigateRewritten(1)">&#8594;</span>
            </div>
            <div class="rewritten-text" id="rewrittenText">
                Modified text with highlights will appear here.
            </div>
        </div>
    </div>

    <div class="charts">
        <div class="chart-container">
            <canvas id="chart1"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="chart2"></canvas>
        </div>
    </div>

    <div class="bert-score" id="bertScore">
        BERT Score: 88%
    </div>

    <div class="arrows">
        <span class="arrow" onclick="navigate(-1)">&#8592;</span>
        <span class="arrow" onclick="navigate(1)">&#8594;</span>
    </div>

    <script>
        const datasets = [
            {
                topic: "Topic: William Farquhar and Singapore",
                inputText: "People can't be forced to wear school uniforms, I mean each person has their own wish whether they want to or don't want to wear school uniforms. I think each principal should think once again regarding the uniforms and should make a decision whether to make uniforms compulsory or not.",
                rewrittenTexts: [
                    { headerValue: "Toxic Emotions", text: "School uniforms should be approached as a matter of individual preference. Each person has their own perspective on whether they wish to wear a uniform or not. It might be valuable for school principals to thoughtfully reconsider the current policies and assess whether making uniforms mandatory aligns with the diverse needs and preferences of the students." },
                    { headerValue: "Constructive Feedback", text: "School uniforms represent a unifying symbol for students but should remain an optional choice to respect individuality and personal expression." }
                ],
                bertScore: "BERT Score: 88%",
                chart1Data: { labels: ["A", "B", "C", "D"], values: [10, 15, 7, 20] },
                chart2Data: { labels: ["E", "F", "G", "H"], values: [25, 18, 12, 22] }
            }
        ];

        let currentIndex = 0;
        let rewrittenIndex = 0;

        const ctx1 = document.getElementById('chart1').getContext('2d');
        const ctx2 = document.getElementById('chart2').getContext('2d');

        const chart1 = new Chart(ctx1, {
            type: 'bar',
            data: {
                labels: datasets[0].chart1Data.labels,
                datasets: [{
                    label: 'Values',
                    data: datasets[0].chart1Data.values,
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: { scales: { y: { beginAtZero: true } } }
        });

        const chart2 = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: datasets[0].chart2Data.labels,
                datasets: [{
                    label: 'Values',
                    data: datasets[0].chart2Data.values,
                    backgroundColor: 'rgba(192, 75, 75, 0.2)',
                    borderColor: 'rgba(192, 75, 75, 1)',
                    borderWidth: 1
                }]
            },
            options: { scales: { y: { beginAtZero: true } } }
        });

        function navigate(direction) {
            currentIndex += direction;
            if (currentIndex < 0) currentIndex = datasets.length - 1;
            if (currentIndex >= datasets.length) currentIndex = 0;

            rewrittenIndex = 0; // Reset rewritten index when switching datasets
            const data = datasets[currentIndex];
            document.getElementById('topic').innerText = data.topic;
            document.getElementById('inputText').innerText = data.inputText;
            updateRewrittenText();
            document.getElementById('bertScore').innerText = data.bertScore;

            chart1.data.labels = data.chart1Data.labels;
            chart1.data.datasets[0].data = data.chart1Data.values;
            chart1.update();

            chart2.data.labels = data.chart2Data.labels;
            chart2.data.datasets[0].data = data.chart2Data.values;
            chart2.update();
        }

        function navigateRewritten(direction) {
            const data = datasets[currentIndex];
            rewrittenIndex += direction;
            if (rewrittenIndex < 0) rewrittenIndex = data.rewrittenTexts.length - 1;
            if (rewrittenIndex >= data.rewrittenTexts.length) rewrittenIndex = 0;
            updateRewrittenText();
        }

        function updateRewrittenText() {
            const data = datasets[currentIndex];
            const rewritten = data.rewrittenTexts[rewrittenIndex];
            document.getElementById('rewrittenHeader').innerText = `Rewritten Text: ${rewritten.headerValue}`;
            updateTextWithDifferences('rewrittenText', data.inputText, rewritten.text);
        }

        function updateTextWithDifferences(elementId, text1, text2) {
            const diff = Diff.diffWords(text1, text2);
            const element = document.getElementById(elementId);
            element.innerHTML = '';
            diff.forEach(part => {
                const span = document.createElement('span');
                span.textContent = part.value;
                if (part.added) span.classList.add('added');
                else if (part.removed) span.classList.add('removed');
                element.appendChild(span);
            });
        }

        navigate(0);
    </script>
</body>
</html>
